(()=>{"use strict";class t{constructor({elem:t,className:e,text:n}){this.element=t,this.className=e,this.text=n}generateElement(){let t=document.createElement(this.element);return this.className&&(t.className=this.className),this.text&&(t.textContent=this.text),t}}const e=document.getElementsByTagName("body")[0];let n="true",a=!1;window.addEventListener("load",(function(){localStorage.getItem("flag")&&(n=localStorage.getItem("flag")),H(0,14),H(14,29),H(29,42),H(42,55),H(55,65),a&&g.call(M[29]),o.focus()})),window.addEventListener("beforeunload",(function(){localStorage.setItem("flag",n)}));let l=new t({elem:"h1",text:"RSS Виртуальная клавиатура"}).generateElement();e.append(l);const s=document.createElement("div");s.style.width="80%",s.style.margin="15px auto",e.append(s);const o=document.createElement("textarea");o.rows="12",o.cols="50",o.className="textarea",s.append(o);let c=new t({elem:"section",className:"keyboard"}).generateElement();e.append(c);let i=new t({elem:"section",className:"info"}).generateElement();e.append(i);let u=new t({elem:"p",text:"Клавиатура создана в операционной системе Windows"}).generateElement();i.append(u);let r=new t({elem:"p",text:"Для переключения языка комбинация: ctrl + alt"}).generateElement();async function d(t){const e=await fetch("../valuesButton.json"),n=await e.json();this.textContent=n.valuesButton[t].content,this.id=n.valuesButton[t].id,this.className=n.valuesButton[t].class,this.setAttribute("data-num",n.valuesButton[t]["data-num"]),this.setAttribute("data-upper",n.valuesButton[t].contentAdd),this.setAttribute("data-lower",n.valuesButton[t].content)}async function m(t){const e=await fetch("../valuesButton.json"),n=await e.json();this.textContent=n.valuesButton[t].contentEn,this.id=n.valuesButton[t].id,this.className=n.valuesButton[t].class,this.setAttribute("data-num",n.valuesButton[t]["data-num"]),this.setAttribute("data-upperen",n.valuesButton[t].contentAddEn),this.setAttribute("data-loweren",n.valuesButton[t].contentEn)}function f(){this.textContent=this.dataset.upper}function v(){this.textContent=this.dataset.upperen}function h(){this.textContent=this.dataset.lower}function p(){this.textContent=this.dataset.loweren}function g(){this.classList.add("colored")}function b(){this.classList.remove("colored")}function E(t){if(o.selectionStart!==o.value.length){let e=o.selectionStart;o.value=o.value.slice(0,o.selectionStart)+t.textContent+o.value.slice(o.selectionEnd),o.selectionStart=e+1,o.selectionEnd=e+1}else o.value+=t.textContent}function x(){o.value+=" "}function L(){o.value+="  "}function C(){let t=document.createElement("p");t.innerHTML="&#9650;";let e=t.innerHTML;o.value+=e}function w(){let t=document.createElement("p");t.innerHTML="&#5130;";let e=t.innerHTML;o.value+=e}function S(){let t=document.createElement("p");t.innerHTML="&#5125;";let e=t.innerHTML;o.value+=e}function B(){let t=document.createElement("p");t.innerHTML="&#9660;";let e=t.innerHTML;o.value+=e}function y(){let t=o.selectionStart;t!==o.value.length&&0!==t?(o.value=o.value.slice(0,t-1)+o.value.slice(t),o.selectionStart=t-1,o.selectionEnd=t-1):t===o.value.length&&0!==t&&(o.value=o.value.slice(0,-1))}function N(){let t;o.selectionStart!==o.value.length&&(t=o.selectionStart),o.value=`${o.value.slice(0,o.selectionStart)}\n${o.value.slice(o.selectionEnd,o.value.length)}`,t&&(o.selectionStart=t,o.selectionEnd=t)}function k(){if(o.selectionStart===o.selectionEnd){let t=o.selectionStart;o.value=o.value.slice(0,o.selectionStart)+o.value.slice(o.selectionEnd+1),o.selectionStart=t,o.selectionEnd=t}o.value=o.value.slice(0,o.selectionStart)+o.value.slice(o.selectionEnd)}function T(){for(let t=0;t<M.length;t+=1)"true"===n&&!0===a?f.call(M[t]):"false"===n&&!0===a&&v.call(M[t])}function A(){for(let t=0;t<M.length;t+=1)"true"===n&&!1===a?h.call(M[t]):"false"===n&&!1===a&&p.call(M[t])}function H(t,e){const a=document.createElement("div");a.className="keybourd__row";for(let l=t;l<e;l+=1){const t=document.createElement("button");"true"===n?d.call(t,l):m.call(t,l),a.append(t)}c.append(a)}i.append(r),document.getElementsByClassName("keyboard")[0].addEventListener("mousedown",(function(t){let e=t.target.closest("button.button-square"),n=t.target.closest("button.button_dark");n?(g.call(n),"CapsLock"===n.textContent?a?(a=!1,b.call(M[29]),A()):(a=!0,T()):"Shift"===n.textContent?(a=!0,T()):"Tab"===n.textContent?L():"Backspace"===n.textContent?y():"Enter"===n.textContent?N():"Del"===n.textContent?k():"Win"===n.textContent?o.textContent+="":n.classList.contains("icono-caretUp")?C():n.classList.contains("icono-caretLeft")?w():n.classList.contains("icono-caretDown")?B():n.classList.contains("icono-caretRight")&&S()):e?(E(e),g.call(e)):t.target.closest("button.button-space")&&(g.call(t.target.closest("button.button-space")),x())})),document.getElementsByClassName("keyboard")[0].addEventListener("mouseup",(function(t){let e=t.target.closest("button.button-square"),n=t.target.closest("button.button_dark");e?b.call(e):t.target.closest("button.button-space")?b.call(t.target.closest("button.button-space")):n&&("CapsLock"!==n.textContent&&b.call(n),"Shift"===n.textContent&&(a=!1,A()))}));let M=document.getElementsByTagName("button");e.addEventListener("keydown",(function(t){t.preventDefault(),o.focus();let e=t.which;for(let t of M)e===Number(t.getAttribute("data-num"))&&(t.classList.contains("button-space")?x():"Tab"===t.textContent?L():"Backspace"===t.textContent?y():"Enter"===t.textContent?N():"Del"===t.textContent?k():"Win"===t.textContent?o.textContent+="":t.classList.contains("icono-caretUp")?C():t.classList.contains("icono-caretLeft")?w():t.classList.contains("icono-caretDown")?B():t.classList.contains("icono-caretRight")?S():E(t),g.call(t));for(let e of M)String(t.code)===e.getAttribute("data-num")&&g.call(e);"CapsLock"===t.code&&(a?(a=!1,b.call(M[29]),A()):(g.call(M[29]),a=!0,T())),t.shiftKey&&(a=!0,T()),t.ctrlKey&&t.altKey&&(n="true"===n?"false":"true",c.innerHTML="",H(0,14),H(14,29),H(29,42),H(42,55),H(55,65))})),e.addEventListener("keyup",(function(t){t.preventDefault();let e=t.which;for(let t of M)e===Number(t.getAttribute("data-num"))&&b.call(t);for(let e of M)String(t.code)===e.getAttribute("data-num")&&b.call(e);"Shift"===t.key&&(a=!1,A())}))})();